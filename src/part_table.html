<?

var rows = JSON.parse(getAllRows(atts.sheetName));

var columnNames = rows[0];
rows = getDataOnly(rows);

?>

<div class="row row-margin">
    <div class="btn-group col-sm-12" role="group">
        <button class="set-content btn btn-primary"
                href="#"
                data-action="deleteRow"
                data-sheet-name="<?= atts.sheetName; ?>"
                data-template="part_form">
            Add new <?= atts.sheetName; ?>
        </button>
    </div>
</div>

<div class="row row-margin">
    <div class="table-responsive col-sm-12">
        <table class="table table-striped table-bordered data-table" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <? for(var t = auditRows; t < columnNames.length; t++) { ?>
                        <th><?= columnNames[t]; ?></th>
                    <? } ?>
                </tr>
            </thead>

            <tbody>
                <? for(var r in rows) { ?>
                    <tr>
                        <? for(var c = auditRows; c < rows[r].length; c++) { ?>

                            <td>
                                <a class="set-content"
                                   href="#"
                                   data-sheet-name="<?= atts.sheetName; ?>"
                                   data-row-id="<?= rows[r][0]; ?>"
                                   data-template="part_form">
                                    <?= rows[r][c]; ?>
                                </a>
                            </td>

                        <? } ?>

                    </tr>
                <? } ?>
            </tbody>
        </table>
    </div>
</div>