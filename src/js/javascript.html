<script>

$(document).ready(function() {

    // Make query params available in this file
    <? for(var key in atts) {?>
        var <?!= key; ?> = <?= atts[key]; ?>;
    <? } ?>

    $('body').on('click', '.trigger-action', function(e) {

        // make sure event is not fired multiple times
        if(e.handled === true) return;
        e.handled = true;

        var data = $(this).data();

        // A form-values data attribute will get the values of all fields in the specified container container
        if(data.formValues) {
            data.formValues = getFormValues(data.formValues)
        }

        runFunction(data.action, [data], function(result) {

            if(data.modal) {
                showModal('Action completed succesfully', data.modal || result || 'Great!');
            };

            if(data.target && data.template) {
                setContent(data.template, data);
            }

        });

    });


    $('body').on('click', '.set-content', function(e) {

        // make sure event is not fired multiple times
        if(e.handled === true) return;
        e.handled = true;

        var data = $(this).data();

        setContent(data.template, data);

    });


    $('ul.dropdown-menu [data-toggle=dropdown]').on('click', function(event) {

		event.preventDefault();
		event.stopPropagation();
		$(this).parent().siblings().removeClass('open');
		$(this).parent().toggleClass('open');
        
	});

});

</script>